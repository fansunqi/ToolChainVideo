Creating LLM cache: cache/gpt35_cache_new_tool_8.pkl...


Initializing Patch Zoomer Tool with model: gpt-4o, sys_prompt: None
!! OpenAI base_url set as https://api.juheai.top/v1/
!! Cache enabled for model: gpt-4o

Initializing Image-Grid-QA Tool with model: gpt-4o
!! OpenAI base_url set as https://api.juheai.top/v1/
!! Cache enabled for model: gpt-4o
Loading liuhaotian/llava-v1.5-7b for Image QA...


Initializing Summarizer Tool with model: gpt-4o-mini
!! OpenAI base_url set as https://api.juheai.top/v1/
!! Cache enabled for model: gpt-4o-mini
!! OpenAI base_url set as https://api.juheai.top/v1/
!! Cache enabled for model: gpt-4o-mini
tool_instances: [<tools.patch_zoomer.PatchZoomer object at 0x7f5f481514f0>, <tools.image_grid_qa.ImageGridQA object at 0x7f5f48151460>, <tools.image_qa.ImageQA object at 0x7f5f480fc730>, <tools.summarizer.Summarizer object at 0x7f5f480a3760>, <tools.frame_selector.FrameSelector object at 0x7f60f133cf70>]
tools: [Tool(name='relevant-patch-zooming-tool', description='placeholder', func=<bound method PatchZoomer.inference of <tools.patch_zoomer.PatchZoomer object at 0x7f5f481514f0>>), Tool(name='image-grid-qa-tool', description="Useful when you want to know the whole event or action in the video. This tool arranges multiple images into an image grid, allowing the MLLM to analyze the events or actions taking place in the video.The input to this tool must be a question, such as 'How many children are in the video?' ", func=<bound method ImageGridQA.inference of <tools.image_grid_qa.ImageGridQA object at 0x7f5f48151460>>), Tool(name='image-question-answering-tool', description="Useful when you need to ask something about the frames in the video.The input to this tool must be a question without options, such as 'How many children are in the video?', instead of 'How many children are in the video? A. 1 B. 2 C. 3 D. 4'.", func=<bound method ImageQA.inference of <tools.image_qa.ImageQA object at 0x7f5f480fc730>>), Tool(name='summarization-tool', description="Useful when you want to summarize the infomation of all visible frames and find the answer.The input to this tool must be a question without options, such as 'How many children are in the video?', instead of 'How many children are in the video? A. 1 B. 2 C. 3 D. 4'.", func=<bound method Summarizer.inference of <tools.summarizer.Summarizer object at 0x7f5f480a3760>>), Tool(name='frame-extraction-tool', description="Useful when you find that the currently sampled frames do not provide enough information and more frames need to be extracted from the video to answer the question.The input to this tool must be a question about the video that remains unresolved. For example, 'How many children are in the video? Choose your answer from below selections: A.one, B.three, C.seven, D.two, E.five.'", func=<bound method FrameSelector.inference of <tools.frame_selector.FrameSelector object at 0x7f60f133cf70>>)]
!! OpenAI base_url set as https://api.juheai.top/v1/
!! Cache enabled for model: gpt-3.5-turbo

Building videomme dataset...

Processing: 001-1
When demonstrating the germany modern christmas tree is initially decorated with apples, candles and berries, which kind of the decoration has the largest number?? Choose your answer from below options: A.Apples, B.Candles, C.Berries, D.The three kinds are of the same number.
